RAG ChatBot with FAISS Embedder and Local Vector Store
======================================================

Context
-------

Often it is necessary to augment the ‘knowledge’ of a ChatBot with
information. This bridges the gap between the general knowledge
contained within General Pre-trained Transformer and specific
information which might not be available to GPT. One of the common
scenarios is that there is a temporal discrepancy between the time when
the GTP has been constituted, and the time when it is utilized. The
other is that the GPT does not posses domain specific knowledge to
provide responses with desired quality. ## Objective In this particular
example, the objective is to augment the GPT with the information from
the domain of *therapeutical massage*, effectively transforming the
transformer into an expert in the domain of sport and remedial massage.
The book is utilized as the source of information which will be utilized
for augmentation. ## Technological Stack The back-end of the whole
system is the ``LangChain``\ package, because of convenient interfaces
to ``TextLoader``, ``PrompTemplate``, and ``ChatPromtTemplate``. In this
particular implementation the choice has been made to make a *local*
vector database via the ``FAISS`` package. Some further capabilities
provided by ``AIMessage``, and ``HumanMessage`` classes are utilized as
well, to fully benefit from ``LangChain`` package. Finally, embeddings
are generated by OpenAIs ``OpenAIEmbedding``, and the GPT has ben also
selected within the OpenAIs eco-system. For the embedding model the
choice has fallen to ``text-embedding-ada-002`` and ``GPT-3.5-Turbo``
has been selected as the ChatBot. ## Methodology The methodological
approach for performing this task consists of following steps. \*
Selection of the General Pre-trained Transformer that will serve as the
base generative model to perform question-answering task. \* Selection
of the embedding model that will transform raw text into its numerical
representation \* Transformation of the additional information from the
text-book into its numerical information (embeddings). \* Creation of
the vector database to store the embeddings. \* Enrichment of the
responses provided by the GPT by augmenting its knowledge with
additional information from the text-book which is acquired according to
its similarity to the question asked by the user. # Implementation Let
us start by import the necessary modules.

.. code:: ipython3

    from rag.embedding import GenericTextLoader, TextSplitter, \
        FAISSEmbedder, RAGChatBot


.. parsed-literal::

    C:\environments\generative_ml\Lib\site-packages\pinecone\data\index.py:1: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html
      from tqdm.autonotebook import tqdm
    

Let us declare the paths towards the input information from the book
about therapeutical massage.

.. code:: ipython3

    SOURCE_DOCUMENT = r'C:\Users\marko\Downloads\Sports And Remedial Massage Therapy ( PDFDrive ).pdf'
    DOCUMENT_TYPE = 'pdf'

Let us read the PDF.

.. code:: ipython3

    text_loader = GenericTextLoader(
        source_document=SOURCE_DOCUMENT,
        document_type=DOCUMENT_TYPE
    )
    text_loader.read_document()
    document = text_loader.get_document()

Let us take a look how many pages there are in the document.

.. code:: ipython3

    print(len(document))


.. parsed-literal::

    362
    

Now it is necessary to split the documents into smaller sections, so
that these sections can be transformed, into numerical representations.

.. code:: ipython3

    splitter = TextSplitter(document=document)
    splitter.split_document()
    converted_document = splitter.get_converted_document()

Let us take a look at the length of the document.

.. code:: ipython3

    print(len(converted_document))


.. parsed-literal::

    1505
    

Let us now create a vector database locally via FEISS library.

.. code:: ipython3

    local_index = FAISSEmbedder(
        pieces_of_text=converted_document,
        local_database='massage_bot',
        database_name='massage_bot'
    )
    local_index.create_vector_database()

As mentioned earlier, the database will be stored locally.

.. code:: ipython3

    local_index.save_vector_database()
    vector_database = local_index.get_vector_store()

Let us try the chat-bot.

.. code:: ipython3

    chat_bot = RAGChatBot(vector_database=vector_database)
    chat_bot.start_chat()


.. parsed-literal::

    >>> I am a massage therapy expert
    

.. parsed-literal::

    >>> Please ask me a question, or type [Q] to exit.  How to perform massage for tennis elbow?
    

.. parsed-literal::

    Self-management is crucial for tennis elbow. Self-massage and stretching can be done multiple times a day. To stretch, fully extend the elbow, palmar-flex the wrist, and slightly pronate the forearm.
    
    For the massage, use the palm of your hand to apply deep friction into the muscles. You can also use one hand to treat the other with lighter techniques.
    
    Apply friction around the elbow joint in both supine and prone positions. In the supine position, extend the patient's arm over their head, supported by you. Use one hand to apply deep strokes along the muscle.
    
    Stretching the muscles slightly during the massage increases effectiveness. Working from both sides of the couch allows for different angles and directions. Elbow techniques in this position are potent but require caution.
    

.. parsed-literal::

    >>> Please ask me a question, or type [Q] to exit.  Do you know any advanced techniques for massage of tennis elbow?
    

.. parsed-literal::

    I'm not aware of any advanced techniques specifically for tennis elbow massage. However, incorporating myofascial release, trigger point therapy, and cross-fiber friction techniques can be beneficial. 
    
    Myofascial release helps release tension in the fascia surrounding the muscles, while trigger point therapy targets specific points of pain. Cross-fiber friction can break down adhesions and scar tissue, promoting healing in the affected area. 
    
    Always remember to work within the client's pain tolerance and communicate throughout the session to ensure their comfort and safety.
    

.. parsed-literal::

    >>> Please ask me a question, or type [Q] to exit.  How about SRT technique?
    

.. parsed-literal::

    To perform the STR (Soft Tissue Release) technique for tennis elbow, start with the arm hanging down and the elbow locked in full extension by contracting the triceps. Use the fingers of one hand to press firmly into the affected tissues while shaking the whole arm with the other hand. Keep the wrist loose during the massage for optimal joint mobility.
    
    Self-massage and stretching are key for managing tennis elbow, especially for individuals at high risk. These techniques can be done several times a day as needed. Remember to fully extend the elbow, palmar-flex the wrist, and slightly pronate the forearm during stretching exercises.
    
    STR is commonly used on muscles but can also be effective on tendons and ligaments. Use a strongly supported thumb for small areas and the fist or heel of the palm for larger areas. Start with the muscle relaxed and in a shortened position before applying the technique for best results.
    
    For deeper treatment, consider applying friction around the elbow joint in supine and prone positions. In the supine position, extend the patient's arm over their head and support it just above the elbows. Use deep strokes along the muscle with the therapist standing at the head of the patient.
    

.. parsed-literal::

    >>> Please ask me a question, or type [Q] to exit.  q
    

.. parsed-literal::

    >>> Thank you for approaching me. I wish you a nice day
    
